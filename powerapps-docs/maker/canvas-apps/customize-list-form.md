---
title: SharePoint リスト フォームのカスタマイズ | Microsoft Docs
description: PowerApps を使用して、SharePoint リストのエントリをユーザーが作成および更新するのに使用するフォームをカスタマイズします。
author: AFTOwen
manager: kvivek
ms.service: powerapps
ms.topic: conceptual
ms.custom: canvas
ms.reviewer: ''
ms.date: 06/11/2018
ms.author: anneta
search.audienceType:
- maker
search.app:
- PowerApps
ms.openlocfilehash: fc2940f726c23c79bcf894bb61c3e6b884ca7112
ms.sourcegitcommit: 429b83aaa5a91d5868e1fbc169bed1bac0c709ea
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/24/2018
ms.locfileid: "42865779"
---
# <a name="customize-a-sharepoint-list-form-by-using-powerapps"></a>PowerApps を使用した SharePoint リスト フォームのカスタマイズ

SharePoint リスト フォームは、ブラウザーで PowerApps を開くことで簡単にカスタマイズすることができます。 C# などの従来のコードを記述したり、InfoPath などの別のアプリをダウンロードしたりする必要はありません。 変更を発行すると、すべてのユーザーが使用できるように、SharePoint リスト内にフォームが埋め込まれます。 PowerApps では、分析レポートを確認したり、条件付き書式を簡単に作成したり、他のデータ ソースに接続することもできます。

このトピックの手順を行うには、カスタマイズがどのように機能しているかを確認できるように、単純なリストを作成してから、同じ概念を独自のリストに適用できます。

> [!NOTE]
> 自分のリストで **[フォームのカスタマイズ]** オプションが使用できない、または正常に動作しない場合は、[PowerApps がサポートしない](connections/connection-sharepoint-online.md#known-issues)データ型が含まれている場合があります。 また、フォームを別のリストまたは[環境](working-with-environments.md)に移動することはできません。

## <a name="prerequisites"></a>前提条件

SharePoint サイトで、以下の列を含むリストを作成します。

- **製品名** (1 行のテキスト)
- **詳細** (はい/いいえ)
- **価格** (通貨)
- **利用可能** (時刻なしの日付)
- **色** (選択)

## <a name="open-the-form-in-powerapps"></a>PowerApps でフォームを開く

1. 作成したリストを開き、コマンド バーで **[新規]** を選択します。

    フォームが開き、追加したフィールドに加え、**タイトル**と**添付ファイル**が表示されます。

1. フォームの上部で、**[カスタマイズ]** を選択します。

    同じブラウザー タブに PowerApps Studio が開きます。

1. **[PowerApps Studio へようこそ]** ダイアログ ボックスが開いたら、**[スキップ]** を選びます。

## <a name="hide-extra-fields"></a>余分なフィールドを非表示にする

画面の中央に、PowerApps によりフォームが表示されますが、このフォームには表示したくないフィールドがいくつか含まれている場合があります。

- **[データ]** ウィンドウで、これらのフィールドのチェック ボックスをオフにします。

  - **Title**
  - **更新日**
  - **作成日**
  - **作成者**
  - **更新者**
  - **ID**

    これらのフィールドがフォームから消え、作成したフィールドだけが残ります。

    ![フィールド リスト](./media/customize-list-form/field-list.png)

## <a name="set-conditional-formatting"></a>条件付き書式を設定する

**[詳細]** を [はい] に設定した場合にのみ、**[価格]**、**[利用可能]**、**[色]** のフィールドが表示されるように構成できます。

1. **[価格]** カードをクリックするかタップして選択します。

    ![[利用可能] カードの選択](./media/customize-list-form/select-card.png)

1. プロパティ リストで、**[Visible]** を選択します。

    ![Visible プロパティの選択](./media/customize-list-form/select-property.png)

1. 数式バーに、次の式を入力するか貼り付けます。

    **If(DataCardValue3.Value = true, true)**

    ![Visible プロパティの値の設定](./media/customize-list-form/build-formula.png)

1. **[利用可能]** と **[色]** カードで、最後の 3 つの手順を繰り返します。

1. Alt キーを押しながら、**[詳細]** トグルをクリックまたはタップして、複数回選択します。

    構成した 3 つのフィールドが表示され、フォームから消えます。

1. (省略可能) 次のようなさまざまな方法で、フォームをカスタマイズします。

    - サイズ、向き、またはその両方を変更する (例: [フォームの幅を広げる](set-aspect-ratio-portrait-landscape.md))。
    - ユーザーが[添付ファイルをアップロード](controls/properties-text.md)できるようにコントロールを追加する。
    - [ルックアップ フィールド](sharepoint-lookup-fields.md)を作成する。

## <a name="save-publish-and-show-the-form"></a>フォームを保存、発行、表示する

1. **[ファイル]** メニューを開き、**[保存]** を選択し、**[SharePoint に発行]** を 2 回選択します。

1. 左上隅で、戻る矢印を選択し、**[SharePoint に戻る]** を選択します。

1. コマンド バーで **[新規]** を選択し、カスタマイズしたフォームを開きます。

1. **[詳細]** トグルを複数回選択し、最後の 3 つのフィールドの表示を切り替えます。

[さらにフォームをカスタマイズする](sharepoint-form-integration.md)には、そのフォームを開き、フォームの上部にある **[カスタマイズ]** を選択し、変更を行い、保存して発行します。

## <a name="use-the-default-form"></a>既定のフォームを使用する

1. SharePoint でリストから (右上隅の歯車アイコンを選んで) 設定ページを開き、**[リストの設定]** を選択します。

2. **[全般設定]** の下で **[フォームの設定]** を選択します。

3. **[フォームの設定]** ページで、これらのオプションのいずれかを選択し、**[OK]** を選択します。

    - **既定の SharePoint フォームを使用する**: ユーザーがリストを開き、コマンド バーで **[新規]** を選択すると、そのリストの既定のフォームが表示されます。

    - **Use a custom form created in PowerApps \(PowerApps で作成されたカスタム フォームを使用する\)**: ユーザーがリストを開き、コマンド バーで **[新規]** を選択すると、カスタム フォームが表示されます  (または、PowerApps でフォームをもう一度発行することもできます)。

    これらのオプションは、必要に応じて切り替えることができます。

    ![[フォームの設定] オプション](./media/customize-list-form/form-settings.png)

## <a name="delete-the-custom-form"></a>カスタム フォームの削除

1. SharePoint でリストから (右上隅の歯車アイコンを選んで) 設定ページを開き、**[リストの設定]** を選択します。

1. **[全般設定]** の下で **[フォームの設定]** を選択します。

1. **[フォームの設定]** ページで、**[既定の SharePoint フォームを使用する]** を選択し、**[Delete custom form]\(カスタム フォームの削除\)** を選択します。

    ![カスタム フォームの削除](./media/customize-list-form/use-default-sharepoint.png)

## <a name="q--a"></a>Q & A

### <a name="forms-vs-apps"></a>フォームとアプリ

**Q:** カスタマイズしたフォームは、SharePoint または PowerApps から作成したスタンドアロンのアプリとどう違うのですか?

**A:** SharePoint リストのフォームをカスタマイズする場合、PowerApps Studio または PowerApps Mobile でフォームがアプリとして表示されません。 フォームは、それを作成したリストからのみ開くことができます。

**Q:** SharePoint リスト内のデータを管理するためのフォーをカスタマイズする必要があるのは、どのような場合ですか? また、スタンドアロン アプリを作成する必要があるのはどのような場合ですか?

**A:** ユーザーが SharePoint を離れることなく、(たとえばデスクトップ ブラウザーなどで) データを管理できるようにする場合は、フォームをカスタマイズします。 ユーザーが SharePoint の外部で (たとえばモバイル デバイスなどで) データを管理できるようにする場合は、アプリを作成します。

**Q:** フォームをカスタマイズし、同じリストのアプリを作成できますか?

**A:** はい。

**Q:** リストをカスタマイズし、同じ機能のアプリを作成できますか?

**A:** はい。

**Q:** 所属組織の既定の環境以外の環境でフォームをカスタマイズできますか?

**A:** いいえ。

### <a name="manage-your-custom-form"></a>カスタム フォームを管理する

**Q:** 自分のフォームを他のユーザーと簡単に共有するにはどうすればよいですか?

**A:** フォームを開き、**[リンクのコピー]** を選択し、フォームを使用するすべてのユーザーにリンクを送信します。

**Q:** 他のユーザーに変更を見せずに、フォームを更新できますか?

**A:** はい。 フォームの変更と保存は何度でもできますが、変更内容は **[SharePoint に発行]** を 2 回選択するまで他のユーザーには表示されません。

**Q:** リスト フォームをカスタマイズしたけれど間違えた場合は、以前のバージョンに戻すことができますか?

**A:** はい。

1. リストを開き、コマンド バーで **[PowerApps]** を選択し、**[フォームをカスタマイズ]** を選択します。

1. PowerApps Studio で、**[ファイル]**、**[すべてのバージョンの表示]** の順に選択します。 **[バージョン]** ページが新しいブラウザー タブに表示されます。

    > [!NOTE]
    > **[すべてのバージョンの表示]** ボタンが表示されていない場合は、**[保存]** を選択します。 ボタンが表示されるはずです。

1. **[バージョン]** ページ (つまり、ブラウザー タブ) を閉じずに、元のブラウザー タブの **[保存]** ページに戻って、左側のナビゲーション ウィンドウの上部にある矢印をクリックまたはタップします。次に、**[SharePoint に戻る]** をクリックまたはタップしてフォームのロックを解除し、PowerApps Studio を閉じます。

1. さきほどのブラウザー タブの **[バージョン]** ページに戻り、復元するバージョンを見つけて、**[復元]** を選択します。

    > [!NOTE]
    > フォームが別のユーザーによってロックされているために復元が失敗したというエラー メッセージが表示された場合は、そのユーザーがフォームのロックを解除するまで待機してからやり直してください。

**Q:** リスト間でフォームを移動できますか?

**A:** いいえ。

### <a name="administer-your-custom-form"></a>カスタム フォームを管理する

**Q:** フォームを共有する方法を教えてください

**A:** フォームを共有する必要はありません。フォームは、SharePoint リストからアクセス許可を継承します。 フォームのカスタマイズが完了したら、他のユーザーが使用できるように[そのフォームを SharePoint に発行しなおす](customize-list-form.md#save-and-publish-the-list-form-back-to-sharepoint)だけです。

**Q:** フォームをカスタマイズできるのは誰ですか?

**A:** 関連リストを管理、設計、または編集する SharePoint アクセス許可を持つ任意のユーザーです。

**Q:** カスタム リスト フォームの作成や使用に、PowerApps のライセンスは必要ですか?

**A:** [PowerApps を含む Office 365 プラン](../../administrator/pricing-billing-skus.md#licenses)が必要です。

**Q:** ゲスト ユーザーがカスタム フォームを含むリストにアクセスするとどうなりますか?

**A:** ゲスト ユーザーが PowerApps を使用してカスタマイズされているリスト フォームにアクセスしようとすると、エラー メッセージが表示されます。

**Q:** 管理者が所属組織のすべてのカスタマイズされたフォームのリストを取得する方法を教えてください。

**A:** PowerApps のテナント管理者であるか、組織の既定の PowerApps 環境に対する環境管理者アクセス許可を持っている場合は、次のように操作します。

1. [PowerApps 管理センター](https://admin.powerapps.com)で、環境のリストから、組織の既定の環境を選択します。

1. 既定の環境のページ上部で、**[リソース]** を選択します。

1. アプリのリストから、アプリの種類が **SharePoint Form** のアプリを探します。これらは、カスタマイズされたフォームです。

    ![カスタマイズされたフォームのリスト](./media/customize-list-form/all-customized-forms.png)
